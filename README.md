# DNS延迟测试工具

这是一个用于测试DNS服务器响应延迟的Python工具，可以帮助您评估不同DNS服务器的性能，包括支持自定义端口的DNS服务器。

## 功能特性

- 测试指定DNS服务器的响应延迟
- 支持自定义端口的DNS服务器
- 多次测试并计算统计数据（成功率、最小/最大/平均延迟）
- 简洁明了的命令行界面
- 详细的测试结果输出

## 安装依赖

在使用前，需要安装Python和必要的依赖包：

```bash
pip install dnspython
```

## 使用方法

基本语法：

```bash
python "dns delay testing.py" --dns <DNS服务器IP>[:端口] [选项]
```

### 命令行参数

- `--dns`：DNS服务器IP地址（必需），支持带端口格式（如：8.8.8.8:532）
- `--domain`：测试域名（默认：baidu.com）
- `--count`：测试次数（默认：5）
- `--timeout`：超时时间（秒，默认：5）
- `-h`, `--help`：显示帮助信息

### 使用示例

```bash
# 使用Google的公共DNS服务器测试（默认端口）
python "dns delay testing.py" --dns 8.8.8.8

# 使用指定端口的DNS服务器测试
python "dns delay testing.py" --dns 8.8.8.8:53 --domain google.com

# 自定义测试次数和超时时间
python "dns delay testing.py" --dns 43.133.224.74:532 --count 10 --timeout 3
```

## 测试原理

DNS延迟测试的原理是通过测量从发送DNS查询请求到接收到响应的时间间隔来评估DNS服务器的响应速度。

具体实现：

1. 使用`time.perf_counter()`在DNS查询前后分别记录时间点
2. 向指定的DNS服务器发送A记录查询请求（解析域名的IPv4地址）
3. 计算查询完成后的时间差，并转换为毫秒显示
4. 多次测试后，计算成功率、最小延迟、最大延迟和平均延迟等统计数据

## 输出说明

测试完成后，程序会输出详细的测试结果，包括：

- DNS服务器地址和端口
- 测试域名
- 测试次数和超时时间
- 每次测试的结果和延迟时间
- 测试汇总统计（成功率、最小/最大/平均延迟）
- 测试开始和结束时间

## 注意事项

- 测试结果可能受到网络环境的影响，请在稳定的网络环境下进行测试
- 对于公共DNS服务器，建议进行多次测试以获得更准确的结果
- 如果测试失败，程序会显示具体的错误信息
